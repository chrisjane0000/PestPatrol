<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pest Patrol</title>
  <style>
    /* Reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }

    body {
      background-image: url('./images/pest patrol wireframe (1).jpg');
      background-size: cover;
      background-attachment: fixed;
      color: white;
    }

    /* Navbar */
    nav {
      background: linear-gradient(to right, #8ed14b);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      position: relative;
    }

    nav img {
      width: 55px;
    }

    nav ul {
      list-style: none;
      display: flex;
      gap: 25px;
    }

    nav ul li a {
      text-decoration: none;
      color: white;
      font-weight: bold;
      font-size: 18px;
      transition: color 0.3s;
    }

    nav ul li a:hover {
      color: #222;
    }

    /* Profile Dropdown */
    .profile-container {
      position: relative;
      cursor: pointer;
    }

    .profile-icon {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      background: #eee url('https://img.icons8.com/ios-filled/50/user.png') center/60% no-repeat;
    }

    .dropdown {
      position: absolute;
      top: 60px;
      right: 0;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      display: none;
      flex-direction: column;
      min-width: 120px;
      z-index: 100;
    }

    .dropdown a {
      color: black;
      padding: 10px;
      text-decoration: none;
      border-bottom: 1px solid #eee;
      transition: background 0.3s;
    }

    .dropdown a:last-child {
      border-bottom: none;
    }

    .dropdown a:hover {
      background-color: #f0f0f0;
    }

    /* Content Section */
    .container {
      padding: 50px 20px;
      text-align: center;
      background: rgba(0, 0, 0, 0.55);
      margin: 40px auto;
      border-radius: 15px;
      max-width: 1200px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.5);
    }

    .container h2 {
      margin-bottom: 30px;
      font-size: 24px;
      color: #fff;
      text-shadow: 1px 1px 6px rgba(0,0,0,0.8);
    }

    .steps {
      display: flex;
      justify-content: center;
      gap: 40px;
      flex-wrap: wrap;
    }

    .step {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      padding: 25px 20px;
      border-radius: 15px;
      backdrop-filter: blur(6px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .step:hover {
      transform: translateY(-8px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.7);
    }

    .step img {
      width: 85px;
      height: 85px;
      margin-bottom: 15px;
      border-radius: 50%;
      border: 2px solid white;
      background: #fff;
      padding: 10px;
    }

    .step h3 {
      margin-bottom: 10px;
      font-size: 20px;
      color: #FFD700;
    }

    .step p {
      font-size: 15px;
      color: #f0f0f0;
    }

    /* Pest Table Section */
    .pest-table-container {
      max-width: 800px;
      margin: 60px auto;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }

    .pest-table-container h3 {
      text-align: center;
      color: #2d4a1f;
      margin-bottom: 20px;
      font-size: 22px;
      font-weight: bold;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      border: 1px solid #cce0b3;
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: #dff0c8;
      color: #2d4a1f;
      font-size: 16px;
    }

    td {
      background-color: #f6ffef;
      color: #333;
    }

    td img {
      width: 60px;
      height: 60px;
      border-radius: 5px;
    }

    .species-name {
      font-weight: bold;
      color: #2d4a1f;
    }

    .species-sub {
      font-style: italic;
      color: #555;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav>
    <img src="./images/logo.png" alt="Pest Patrol Logo">
    <ul>
      <li><a href="./home.html">HOME</a></li>
      <li><a href="./about.html">ABOUT</a></li>
      <li><a href="./features.html">FEATURE</a></li>
      <li><a href="./detected.html">DETECTED PEST</a></li>
    </ul>
    <div class="profile-container" onclick="toggleDropdown()">
      <div class="profile-icon" id="profileImage"></div>
      <div class="dropdown" id="profileDropdown">
        <a href="./profile.html">Profile</a>
        <a href="./index.html">Logout</a>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="container">
    <h2>
      Pest Patrol utilizes an intelligent and automated process to detect, analyze, 
      and respond to pest activity in the field. The system is built for efficiency, 
      sustainability, and precision through the following three-step operation:
    </h2>

    <div class="steps">
      <div class="step">
        <img src="https://cdn-icons-png.flaticon.com/512/1029/1029183.png" alt="Detect">
        <h3>Detect</h3>
        <p>Smart sensors and cameras monitor the field in real-time to identify pest presence.</p>
      </div>

      <div class="step">
        <img src="https://cdn-icons-png.flaticon.com/512/3524/3524659.png" alt="Analyze">
        <h3>Analyze</h3>
        <p>Collected data is processed using machine learning algorithms to confirm pest types and evaluate threat levels.</p>
      </div>

      <div class="step">
        <img src="https://cdn-icons-png.flaticon.com/512/3208/3208726.png" alt="Respond">
        <h3>Respond</h3>
        <p>Based on the analysis, the system either activates an organic pesticide sprayer or an ultrasonic rodent deterrent module.</p>
      </div>
    </div>
  </div>

  <!-- Pest Table -->
  <div class="pest-table-container">
    <h3>PestPatrol Available Pests</h3>
    <table>
      <tr>
        <th>Pest</th>
        <th>Species</th>
        <th>Attack Time</th>
        <th>Damage</th>
      </tr>
      <tr>
        <td><img src="./images/fall-armyworm-1.webp" alt="Fall Armyworm"></td>
        <td>
          <div class="species-name">Fall Armyworm</div>
          <div class="species-sub"><i>Spodoptera frugiperda</i></div>
        </td>
        <td>üåô Nocturnal</td>
        <td><b>High</b></td>
      </tr>
      <tr>
        <td><img src="./images/cornborer.jpg" alt="Asian Corn Borer"></td>
        <td>
          <div class="species-name">Asian Corn Borer</div>
          <div class="species-sub"><i>Ostrinia furnacalis</i></div>
        </td>
        <td>üåô Nocturnal</td>
        <td><b>High</b></td>
      </tr>
      <tr>
        <td><img src="./images/rodent.jpg" alt="Rodent"></td>
        <td>
          <div class="species-name">Rodent</div>
          <div class="species-sub"><i>Mammalia</i></div>
        </td>
        <td>‚òÄÔ∏è Both</td>
        <td><b>Medium</b></td>
      </tr>
    </table>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = "https://ahjlcrpzrxgvkjtcwaua.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFoamxjcnB6cnhndmtqdGN3YXVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTUwMTcsImV4cCI6MjA3NTI5MTAxN30.tpt7EU7l-Fd5I1IQqfv9e0_2hKaQKOnbasDMjf9hrh8";
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    // Dropdown toggle
    function toggleDropdown() {
      const dropdown = document.getElementById('profileDropdown');
      dropdown.style.display = dropdown.style.display === 'flex' ? 'none' : 'flex';
    }

    // Hide dropdown when clicking outside
    window.addEventListener('click', (e) => {
      const container = document.querySelector('.profile-container');
      if (!container.contains(e.target)) {
        document.getElementById('profileDropdown').style.display = 'none';
      }
    });

    // Load profile image
    async function loadProfileImage() {
      try {
        const { data: { user }, error: userErr } = await supabaseClient.auth.getUser();
        if (userErr || !user) return;

        const { data, error: fetchError } = await supabaseClient
          .from("users")
          .select("image_url")
          .eq("auth_id", user.id)
          .single();

        if (fetchError) {
          console.error("Error loading profile image:", fetchError);
          return;
        }

        const profileDiv = document.getElementById("profileImage");
        if (!profileDiv) return;

        if (data?.image_url) {
          profileDiv.style.backgroundImage = `url('${data.image_url}')`;
          profileDiv.style.backgroundSize = "cover";
          profileDiv.style.backgroundPosition = "center";
          profileDiv.style.backgroundRepeat = "no-repeat";
        }
      } catch (err) {
        console.error("Unexpected error loading profile image:", err);
      }
    }

    loadProfileImage();
  </script>
</body>
</html>
